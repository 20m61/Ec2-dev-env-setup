{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.199.0"},"children":{"DevEnvStack":{"id":"DevEnvStack","path":"DevEnvStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.199.0"},"children":{"DevEnvVpc":{"id":"DevEnvVpc","path":"DevEnvStack/DevEnvVpc","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Vpc","version":"2.199.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DevEnvStack/DevEnvVpc/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPC","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPC","aws:cdk:cloudformation:props":{"cidrBlock":"10.0.0.0/16","enableDnsHostnames":true,"enableDnsSupport":true,"instanceTenancy":"default","tags":[{"key":"Name","value":"DevEnvStack/DevEnvVpc"}]}}},"PublicSubnet1":{"id":"PublicSubnet1","path":"DevEnvStack/DevEnvVpc/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.199.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"DevEnvStack/DevEnvVpc/PublicSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[0,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.0.0/18","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"DevEnvStack/DevEnvVpc/PublicSubnet1"}],"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}},"Acl":{"id":"Acl","path":"DevEnvStack/DevEnvVpc/PublicSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.199.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"DevEnvStack/DevEnvVpc/PublicSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"DevEnvStack/DevEnvVpc/PublicSubnet1"}],"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"DevEnvStack/DevEnvVpc/PublicSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"DevEnvVpcPublicSubnet1RouteTable22473981"},"subnetId":{"Ref":"DevEnvVpcPublicSubnet1Subnet635A9A73"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"DevEnvStack/DevEnvVpc/PublicSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"DevEnvVpcIGW66ABFE0E"},"routeTableId":{"Ref":"DevEnvVpcPublicSubnet1RouteTable22473981"}}}},"EIP":{"id":"EIP","path":"DevEnvStack/DevEnvVpc/PublicSubnet1/EIP","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnEIP","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::EIP","aws:cdk:cloudformation:props":{"domain":"vpc","tags":[{"key":"Name","value":"DevEnvStack/DevEnvVpc/PublicSubnet1"}]}}},"NATGateway":{"id":"NATGateway","path":"DevEnvStack/DevEnvVpc/PublicSubnet1/NATGateway","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnNatGateway","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::NatGateway","aws:cdk:cloudformation:props":{"allocationId":{"Fn::GetAtt":["DevEnvVpcPublicSubnet1EIP3BC667C6","AllocationId"]},"subnetId":{"Ref":"DevEnvVpcPublicSubnet1Subnet635A9A73"},"tags":[{"key":"Name","value":"DevEnvStack/DevEnvVpc/PublicSubnet1"}]}}}}},"PublicSubnet2":{"id":"PublicSubnet2","path":"DevEnvStack/DevEnvVpc/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.199.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"DevEnvStack/DevEnvVpc/PublicSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[1,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.64.0/18","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"DevEnvStack/DevEnvVpc/PublicSubnet2"}],"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}},"Acl":{"id":"Acl","path":"DevEnvStack/DevEnvVpc/PublicSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.199.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"DevEnvStack/DevEnvVpc/PublicSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"DevEnvStack/DevEnvVpc/PublicSubnet2"}],"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"DevEnvStack/DevEnvVpc/PublicSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"DevEnvVpcPublicSubnet2RouteTable117827DD"},"subnetId":{"Ref":"DevEnvVpcPublicSubnet2SubnetC1D25FAD"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"DevEnvStack/DevEnvVpc/PublicSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"DevEnvVpcIGW66ABFE0E"},"routeTableId":{"Ref":"DevEnvVpcPublicSubnet2RouteTable117827DD"}}}}}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"DevEnvStack/DevEnvVpc/PrivateSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.199.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"DevEnvStack/DevEnvVpc/PrivateSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[0,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.128.0/18","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"DevEnvStack/DevEnvVpc/PrivateSubnet1"}],"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}},"Acl":{"id":"Acl","path":"DevEnvStack/DevEnvVpc/PrivateSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.199.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"DevEnvStack/DevEnvVpc/PrivateSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"DevEnvStack/DevEnvVpc/PrivateSubnet1"}],"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"DevEnvStack/DevEnvVpc/PrivateSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"DevEnvVpcPrivateSubnet1RouteTable1AB70A49"},"subnetId":{"Ref":"DevEnvVpcPrivateSubnet1Subnet80F612C9"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"DevEnvStack/DevEnvVpc/PrivateSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"DevEnvVpcPublicSubnet1NATGateway41923379"},"routeTableId":{"Ref":"DevEnvVpcPrivateSubnet1RouteTable1AB70A49"}}}}}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"DevEnvStack/DevEnvVpc/PrivateSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.199.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"DevEnvStack/DevEnvVpc/PrivateSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[1,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.192.0/18","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"DevEnvStack/DevEnvVpc/PrivateSubnet2"}],"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}},"Acl":{"id":"Acl","path":"DevEnvStack/DevEnvVpc/PrivateSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.199.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"DevEnvStack/DevEnvVpc/PrivateSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"DevEnvStack/DevEnvVpc/PrivateSubnet2"}],"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"DevEnvStack/DevEnvVpc/PrivateSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"DevEnvVpcPrivateSubnet2RouteTable9D3742F1"},"subnetId":{"Ref":"DevEnvVpcPrivateSubnet2Subnet9FFD2A46"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"DevEnvStack/DevEnvVpc/PrivateSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"DevEnvVpcPublicSubnet1NATGateway41923379"},"routeTableId":{"Ref":"DevEnvVpcPrivateSubnet2RouteTable9D3742F1"}}}}}},"IGW":{"id":"IGW","path":"DevEnvStack/DevEnvVpc/IGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInternetGateway","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::InternetGateway","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"DevEnvStack/DevEnvVpc"}]}}},"VPCGW":{"id":"VPCGW","path":"DevEnvStack/DevEnvVpc/VPCGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCGatewayAttachment","aws:cdk:cloudformation:props":{"internetGatewayId":{"Ref":"DevEnvVpcIGW66ABFE0E"},"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}}}},"DevEnvRole":{"id":"DevEnvRole","path":"DevEnvStack/DevEnvRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.199.0","metadata":[]},"children":{"ImportDevEnvRole":{"id":"ImportDevEnvRole","path":"DevEnvStack/DevEnvRole/ImportDevEnvRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.199.0","metadata":[]}},"Resource":{"id":"Resource","path":"DevEnvStack/DevEnvRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ec2.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonSSMManagedInstanceCore"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonS3FullAccess"]]}]}}}}},"DevEnvSG":{"id":"DevEnvSG","path":"DevEnvStack/DevEnvSG","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.199.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DevEnvStack/DevEnvSG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Allow SSH and HTTPS","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":22,"toPort":22,"description":"Allow SSH"},{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":443,"toPort":443,"description":"Allow HTTPS"},{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":8080,"toPort":8080,"description":"Allow code-server"}],"vpcId":{"Ref":"DevEnvVpc4439C3E3"}}}}}},"DevEnvInstance":{"id":"DevEnvInstance","path":"DevEnvStack/DevEnvInstance","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Instance","version":"2.199.0","metadata":[]},"children":{"InstanceProfile":{"id":"InstanceProfile","path":"DevEnvStack/DevEnvInstance/InstanceProfile","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnInstanceProfile","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::InstanceProfile","aws:cdk:cloudformation:props":{"roles":[{"Ref":"DevEnvRole854FA08A"}]}}},"Resource":{"id":"Resource","path":"DevEnvStack/DevEnvInstance/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInstance","version":"2.199.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Instance","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[0,{"Fn::GetAZs":""}]},"blockDeviceMappings":[{"deviceName":"/dev/xvda","ebs":{"volumeSize":100,"volumeType":"gp3"}}],"iamInstanceProfile":{"Ref":"DevEnvInstanceInstanceProfileEF0ED2B4"},"imageId":{"Ref":"SsmParameterValueawsserviceamiamazonlinuxlatestal2023amikernel61arm64C96584B6F00A464EAD1953AFF4B05118Parameter"},"instanceType":"t4g.xlarge","securityGroupIds":[{"Fn::GetAtt":["DevEnvSG8A1BEE22","GroupId"]}],"subnetId":{"Ref":"DevEnvVpcPrivateSubnet1Subnet80F612C9"},"tags":[{"key":"Name","value":"DevEnvStack/DevEnvInstance"}],"userData":{"Fn::Base64":"#!/bin/bash\nset -eux\n# 基本ツール\nsudo yum update -y\nsudo yum install -y git docker awscli\nsudo systemctl enable --now docker\nsudo usermod -aG docker ec2-user\n\n# code-server install\ncurl -fsSL https://code-server.dev/install.sh | sh\nsudo systemctl enable --now code-server@$USER\n\n# git worktree用ディレクトリ\nmkdir -p /home/ec2-user/repos\nchown ec2-user:ec2-user /home/ec2-user/repos\n\n# 任意: dotfilesや初期セットアップ\n# su - ec2-user -c 'git clone ...'\n"}}}}}},"SsmParameterValue:--aws--service--ami-amazon-linux-latest--al2023-ami-kernel-6.1-arm64:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter":{"id":"SsmParameterValue:--aws--service--ami-amazon-linux-latest--al2023-ami-kernel-6.1-arm64:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","path":"DevEnvStack/SsmParameterValue:--aws--service--ami-amazon-linux-latest--al2023-ami-kernel-6.1-arm64:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.199.0"}},"SsmParameterValue:--aws--service--ami-amazon-linux-latest--al2023-ami-kernel-6.1-arm64:C96584B6-F00A-464E-AD19-53AFF4B05118":{"id":"SsmParameterValue:--aws--service--ami-amazon-linux-latest--al2023-ami-kernel-6.1-arm64:C96584B6-F00A-464E-AD19-53AFF4B05118","path":"DevEnvStack/SsmParameterValue:--aws--service--ami-amazon-linux-latest--al2023-ami-kernel-6.1-arm64:C96584B6-F00A-464E-AD19-53AFF4B05118","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.199.0","metadata":[]}},"CDKMetadata":{"id":"CDKMetadata","path":"DevEnvStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"DevEnvStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.199.0"}},"Condition":{"id":"Condition","path":"DevEnvStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.199.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"DevEnvStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.199.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"DevEnvStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.199.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}